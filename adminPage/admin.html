<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Colepediya Admin Panel</title>
    <style>

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: rgb(186, 221, 210);
            font-family: 'Lucida Sans', 'Lucida Sans Regular', 'Lucida Grande', 'Lucida Sans Unicode', Geneva, Verdana, sans-serif;
        }
        
        nav div {
            background-color: rgba(34, 3, 80, 0.769);
            color: aliceblue;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 5%;
            font-size: 1.4em;
        }
        
        nav div h2 {
            text-shadow: 0 0 10px rgb(0, 110, 255);
        }
        
        nav div h5 {
            display: flex;
            background-color: rgb(10, 14, 49);
            align-items: center;
            padding: 10px;
            border-radius: 5px;
            text-decoration: none;
            color: whitesmoke;
            transition: background-color 0.3s, box-shadow 0.3s;
        }
        
        nav div h5:hover {
            background-color: rgb(157, 14, 14);
            box-shadow: -1px -1px 4px black;
        }
        
        .main {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        
        .main h1 {
            width: fit-content;
            text-align: center;
            padding: 15px;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            color: rgb(0, 0, 87);
            margin:0 5%;
        }
        
        form {
            border: 2px solid;
            border-radius: 5px;
            background-color: rgba(148, 160, 255, 0.416);
            width: 100%;
            max-width: 700px;
            padding: 20px;
        }
        
        form div {
            display: flex;
            flex-direction: column;
            margin-bottom: 10px;
        }
        
        input {
            padding: 10px;
            font-size: 1em;
            width: 100%;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-sizing: border-box;
        }
        
        input[type=file] {
            background-color: rgb(200, 200, 255);
            cursor: pointer;
        }
        
        input[type=submit] {
            width: 100%;
            margin: 10px auto;
            background-color: rgb(32, 32, 210);
            border-radius: 4px;
            color: white;
            font-weight: 700;
            cursor: pointer;
        }
/* Style for the "Add Department" button */
.add-department-btn {
    padding: 10px;
    margin: 10px 0;
    background-color: rgb(0, 212, 141);
    border: none;
    border-radius: 5px;
    color: rgb(6, 15, 87);
    font-size: 1.2em;
    cursor: pointer;
    transition: background-color 0.3s, color 0.3s;
}

.add-department-btn:hover {
    background-color: rgb(0, 162, 101);
    color: white;
}

        .colleges {
            display: flex;
            justify-content: space-between; /* Adjust as needed */
            align-items: center;
            box-shadow: 3px 3px 0;
            font-size: 1.1em;
            font-family: Arial, Helvetica, sans-serif;
            padding: 0 2vw;
            font-weight: 600;
            flex-wrap: wrap; /* Allow content to wrap to the next line */
        }
        
        .colleges div {
            margin: 3px; /* Reduced margin for spacing */
            padding: 6px; /* Reduced padding for spacing */
            border-radius: 5px;
        }
     
        .dlt-btn {
            background-color: rgb(216, 18, 18);
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
            cursor: pointer;
        }
        
        .dlt-btn:hover {
            background-color: rgb(255, 50, 50);
            color: white;
        }
        
/* Footer styles */
footer {
    background-color: #333;
    color: #fff;
    padding: 20px 0 0 0;
}

.footer-content {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-around;
}

.footer-section {
    flex: 1;
    padding: 0 20px;
}

.footer-section h2 {
    color: #00bcd4;
}

.footer-section p {
    line-height: 1.6;
}

.footer-section ul {
    list-style: none;
    padding: 0;
}

.footer-section a {
    color: #fff;
    text-decoration: none;
    transition: color 0.3s;
}

.footer-section a:hover {
    color: #00bcd4;
}

.footer-bottom {
    text-align: center;
    padding: 10px 0;
    background-color: #111;
}

.footer-bottom p {
    font-size: 0.8em;
}


        @media screen and (max-width: 768px) {
            nav div {
                flex-direction: column;
                text-align: center;
            }
        
            nav div h5 {
                margin-top: 10px;
            }
        
            .main {
                margin: 5vh 5%;
            }
        }
        

    </style>
  </head>
  <body>
    <nav>
      <div>
        <h2>Welcome To Colepediya Admin Panel</h2>
        <a href="/" style="text-decoration: none; color:whitesmoke"><h5>Log Out</h5></a>
      </div>
    </nav>
    <div class="main">
        <h1>ADD A NEW COLLEGE ON SITE</h1>

        <form id="collegeForm" action="/addCollege" method="post" enctype="multipart/form-data">
            <div>
                <label for="college_name">College Name:</label>
                <input type="text" required  name="college_name">
            </div>
            
            <div>
                <label for="university_name">University Name:</label>
                <input type="text" required  name="university_name">
            </div>
            
            <div>
                <label for="college_type">College Type:</label>
                <input type="text" required  name="college_type">
            </div>

            <div>
                <label for="district_name">District Name:</label>
                <input type="text" required  name="district_name">
            </div>

            <div>
                <label for="state_name">State Name:</label>
                <input type="text" required  name="state_name">
            </div>

            <div>
                <label for="admission_fees">Addmission Fees:</label>
                <input type="text" required  name="admission_fees">
            </div>

            <div>
                <label for="semester_fees">Semester Fees:</label>
                <input type="text" required  name="semester_fees">
            </div>

           <div id="depertment">
                <label for="department">Department:</label>
                <input type="text" name="department" class="department" oninput="this.value = this.value.toUpperCase()">
           </div>
           <div style="justify-content:center; " >
            <div class="add-department-btn" onclick="addDepertment()">ADD DEPERTMENT + </div>
        </div>


            <div>
                <label for="photo">College Photo:</label>
                <input type="file" required  name="photo">
            </div>
            
            <div>
                <input type="submit"  value="Submit To Add College">
            </div>
        </form>
    </div>
<!-- <div>View And Update All Colleges</div> -->
<div id="AllColleges">
<h1 style="background-color: rgb(188, 11, 11); text-align:center">View And Delete A College</h1>
</div>

<script>
    // This function prevents back navigation to authenticated pages
    function preventBack() {
      window.history.forward();
    }
    // Call the preventBack function when the page is loaded
  </script>

  <script>
    const form = document.getElementById('collegeForm');

    form.addEventListener('submit', async (event) => {
      event.preventDefault();
      // Create a FormData object to serialize the form data
      const formData = new FormData(form);
      // Send a POST request to the server
      try {
        const response = await fetch('/addCollege', {
          method: 'POST',
          body: formData,
        });
  
        if (response.ok) {
          // Handle a successful response (e.g., display a success message)
          alert('College added successfully.');
          location.reload();
        } else {
          // Handle errors (e.g., display an error message)
          alert('Failed to add a new college.');
        }
      } catch (error) {
        // Handle network errors (e.g., connection issues)
        alert('Network error:', error);
      }
    });
    function insertAfter(referenceNode, newNode) {
        referenceNode.parentNode.insertBefore(newNode, referenceNode.nextSibling);
      }
    function addDepertment(){
        let dep = document.getElementById('depertment');
        let newNode = document.createElement('div');
        newNode.innerHTML = dep.innerHTML;
        insertAfter(dep,newNode)
    }
  </script>
  <!-- get colleges and delete -->
  <script>
//get college API
let allCollege = fetch('https://collegeserver.onrender.com/collegesAdminPanel');
allCollege.then(response=>{
    if(!response.ok){
        throw new Error(`HTTP error ! Status: ${response.status}`);
    }
    return response.json();
})
.then(data=>{
    //console.log(data);
    let AllColleges = document.getElementById('AllColleges');
    data.forEach(college=>{
        //console.log(college.college_name)
        let div = document.createElement('div');
        let id = college._id;
        div.innerHTML = `
        <div class="colleges">
            <div><div id="name">${college.college_name}</div> </div>
        <div><div class="district">${college.district_name}</div> </div>
        <div class="dlt-btn"><div onclick="deleteCollege('${id}')">DELETE</div>
    </div>
        </div>
        `;
        AllColleges.appendChild(div);
    })
})
async function deleteCollege(id) {
    const url = `https://collegeserver.onrender.com/deleteCollege/${id}`;
let confirm = prompt("Type 'D' For Confirmation");
if (confirm == 'D' || confirm == 'd'){
    try {
        const response = await fetch(url, {
            method: 'POST', // or 'DELETE'
        });

        if (!response.ok) {
            throw new Error(`HTTP error! Status: ${response.status}`);
        } else {
            console.log(`College with ID ${id} deleted successfully.`);
            window.location.reload();
        }
    } catch (error) {
        console.log(`There was an error: ${error}`);
    }
}else{
    alert("Item Not Deleted")
}
}

  </script>

  <footer>
    <div class="footer-content">
        <div class="footer-section about">
            <h2>About Us</h2>
            <p>Explore a vast database of colleges spanning diverse disciplines, from engineering and medicine to arts and social sciences. Each college profile offers key information such as courses offered, admission criteria, campus facilities, faculty credentials, and more.
            </p>
        </div>

        <div class="footer-section contact">
            <h2>Contact Information</h2>
            <p>Email: bwebsite865@gmail.com</p>
            <p>Phone: +91 7501728816</p>
        </div>

        <div class="footer-section links">
            <h2>Quick Links</h2>
            <ul>
                <li><a href="/">Home</a></li>
                <li><a href="/about">About</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
        </div>
    </div>

    <div class="footer-bottom">
        <p>&copy; 2023 Class Buddy JR. All rights reserved.</p>
    </div>
</footer>
  </body>
</html>
